{% extends "base.html" %}

{% block head %}
<link rel=stylesheet type=text/css href="{{ url_for('static', filename='styles/upload.css') }}">
<script type="text/javascript"  src="{{ url_for('static', filename='js/upload.js') }}"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?v=3.11&sensor=false" type="text/javascript"></script>
{% endblock %}

{% block content %}
<div class="boxes">
    <div class="upload">
        <h4>Upload</h4>
        <p class="upload_intro">Here you can submit one or more audio files for analysis and classification.</p>
        <form method="post" enctype="multipart/form-data">
            <div class="file-upload">
                <div class="file-select">
                    <div class="file-select-button" id="fileName">Choose File</div>
                    <div class="file-select-name" id="noFile">No file chosen</div> 
                    <input type="file" name="file" accept="audio/*" class="choose_file" id="chooseFile" multiple>
                </div>
            </div>
            <div class="location">
                <input class="longitude" type="text" name='longitude' placeholder="Longitude">
                <input class="latitude" type="text" name='latitude' placeholder="Latitude">
                <div class="location_icon_div">
                    <i class="fa fa-location-arrow location_icon" aria-hidden="true"></i>
                </div>
            </div>
            <input class="humidity" type="text" name='humidity' placeholder="Humidity">
            <input class="temperature" type="text" name='temp' placeholder="Temperature">
            <input class="light" type="text" name='light' placeholder="Light">
            <input class="submit_file" type="submit" value="Upload">
        </form>
    </div>

    
    </div>
    {% endif %}
</div>

<script type="text/javascript">
    $('.classification').each(function() {
        // var thischart1 = d3.select(this.find('.first_match'))
        var data1 = JSON.parse($(this).attr('data-classification-first'));
        var color1 = ['#23CFEE', '#CACACA'];
        donut_chart(data1, color1, 'chart1');
        $(this).find('.first_match_intro').find('.match_name').html(data1[0]['name']);

        // var thischart2 = d3.select(this.find('.second_match'))
        var data2 = JSON.parse($(this).attr('data-classification-second'));
        var color2 = ['#ED531D', '#CACACA'];
        donut_chart(data2, color2, 'chart2');
        $(this).find('.second_match_intro').find('.match_name').html(data2[0]['name']);

        // var thischart3 = d3.select(this.find('.third_match'))
        var data3 = JSON.parse($(this).attr('data-classification-third'));
        var color3 = ['#ED0C19', '#CACACA'];
        donut_chart(data3, color3, 'chart3');
        $(this).find('.third_match_intro').find('.match_name').html(data3[0]['name']);
    });

    var sampleid = $('#map').attr('data-sampleid');
    var longitude = $('#map').attr('data-longitude');
    var latitude = $('#map').attr('data-latitude');
    show_map(sampleid, latitude, longitude);
</script>
{% endblock %}